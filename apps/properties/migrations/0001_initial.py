# Generated by Django 4.2.16 on 2025-11-21 01:58

from django.conf import settings
import django.core.validators
from django.db import migrations, models
import django.db.models.deletion
import uuid


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
        ('custom_auth', '0001_initial'),
    ]

    operations = [
        migrations.CreateModel(
            name='Property',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('title', models.CharField(max_length=200)),
                ('description', models.TextField()),
                ('property_type', models.CharField(choices=[('apartment', 'Appartement'), ('house', 'Maison'), ('villa', 'Villa'), ('penthouse', 'Penthouse'), ('loft', 'Loft'), ('duplex', 'Duplex'), ('triplex', 'Triplex'), ('studio', 'Studio'), ('commercial', 'Commercial'), ('office', 'Bureau'), ('land', 'Terrain'), ('parking', 'Parking'), ('cellar', 'Cave'), ('garage', 'Garage')], default='apartment', max_length=20)),
                ('status', models.CharField(choices=[('draft', 'Brouillon'), ('available', 'Disponible'), ('under_offer', 'Sous offre'), ('reserved', 'Réservé'), ('sold', 'Vendu'), ('rented', 'Loué'), ('withdrawn', 'Retiré'), ('archived', 'Archivé')], default='draft', max_length=20)),
                ('address_line1', models.CharField(max_length=200)),
                ('address_line2', models.CharField(blank=True, max_length=200)),
                ('city', models.CharField(max_length=100)),
                ('postal_code', models.CharField(max_length=20)),
                ('country', models.CharField(default='Sénégal', max_length=100)),
                ('latitude', models.DecimalField(blank=True, decimal_places=8, max_digits=10, null=True)),
                ('longitude', models.DecimalField(blank=True, decimal_places=8, max_digits=11, null=True)),
                ('price', models.DecimalField(decimal_places=2, max_digits=12, validators=[django.core.validators.MinValueValidator(0)])),
                ('price_per_sqm', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True, validators=[django.core.validators.MinValueValidator(0)])),
                ('surface_area', models.DecimalField(decimal_places=2, max_digits=8, validators=[django.core.validators.MinValueValidator(0)])),
                ('usable_area', models.DecimalField(blank=True, decimal_places=2, max_digits=8, null=True, validators=[django.core.validators.MinValueValidator(0)])),
                ('garden_area', models.DecimalField(blank=True, decimal_places=2, max_digits=8, null=True, validators=[django.core.validators.MinValueValidator(0)])),
                ('rooms', models.PositiveIntegerField(validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(20)])),
                ('bedrooms', models.PositiveIntegerField(validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(10)])),
                ('bathrooms', models.PositiveIntegerField(validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(5)])),
                ('toilets', models.PositiveIntegerField(default=1, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(5)])),
                ('floor', models.CharField(blank=True, max_length=50)),
                ('total_floors', models.PositiveIntegerField(blank=True, null=True)),
                ('year_built', models.PositiveIntegerField(blank=True, null=True, validators=[django.core.validators.MinValueValidator(1800), django.core.validators.MaxValueValidator(2025)])),
                ('energy_class', models.CharField(blank=True, choices=[('A', 'A'), ('B', 'B'), ('C', 'C'), ('D', 'D'), ('E', 'E'), ('F', 'F'), ('G', 'G')], max_length=5, null=True)),
                ('ges_class', models.CharField(blank=True, choices=[('A', 'A'), ('B', 'B'), ('C', 'C'), ('D', 'D'), ('E', 'E'), ('F', 'F'), ('G', 'G')], max_length=5, null=True)),
                ('heating_type', models.CharField(blank=True, choices=[('gas', 'Gaz'), ('electric', 'Électrique'), ('oil', 'Fioul'), ('wood', 'Bois'), ('heat_pump', 'Pompe à chaleur'), ('district', 'Chauffage urbain'), ('solar', 'Solaire')], max_length=50)),
                ('has_balcony', models.BooleanField(default=False)),
                ('has_terrace', models.BooleanField(default=False)),
                ('has_garden', models.BooleanField(default=False)),
                ('has_garage', models.BooleanField(default=False)),
                ('has_parking', models.BooleanField(default=False)),
                ('has_elevator', models.BooleanField(default=False)),
                ('has_fireplace', models.BooleanField(default=False)),
                ('has_pool', models.BooleanField(default=False)),
                ('has_air_conditioning', models.BooleanField(default=False)),
                ('has_security_system', models.BooleanField(default=False)),
                ('furnished', models.BooleanField(default=False)),
                ('furnished_level', models.CharField(choices=[('none', 'Non meublé'), ('partially', 'Partiellement meublé'), ('fully', 'Entièrement meublé')], default='none', max_length=20)),
                ('available_from', models.DateField(blank=True, null=True)),
                ('owner_name', models.CharField(blank=True, max_length=200)),
                ('owner_phone', models.CharField(blank=True, max_length=20)),
                ('owner_email', models.EmailField(blank=True, max_length=254)),
                ('amenities', models.JSONField(blank=True, default=dict)),
                ('additional_features', models.JSONField(blank=True, default=dict)),
                ('meta_title', models.CharField(blank=True, max_length=200)),
                ('meta_description', models.TextField(blank=True, max_length=500)),
                ('featured_image', models.ImageField(blank=True, null=True, upload_to='properties/featured/')),
                ('is_featured', models.BooleanField(default=False)),
                ('is_public', models.BooleanField(default=True)),
                ('show_price', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('published_at', models.DateTimeField(blank=True, null=True)),
                ('view_count', models.PositiveIntegerField(default=0)),
                ('inquiry_count', models.PositiveIntegerField(default=0)),
                ('agency', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='properties', to='custom_auth.agency')),
                ('agent', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='assigned_properties', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Property',
                'verbose_name_plural': 'Properties',
                'db_table': 'properties',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='PropertyVisit',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('visit_type', models.CharField(choices=[('individual', 'Individuelle'), ('group', 'Groupe'), ('virtual', 'Virtuelle'), ('self_visit', 'Visite libre')], default='individual', max_length=20)),
                ('scheduled_date', models.DateTimeField(help_text='Date et heure de la visite')),
                ('duration_minutes', models.PositiveIntegerField(default=60)),
                ('visitor_name', models.CharField(blank=True, max_length=200)),
                ('visitor_email', models.EmailField(blank=True, max_length=254)),
                ('visitor_phone', models.CharField(blank=True, max_length=20)),
                ('visitor_count', models.PositiveIntegerField(default=1)),
                ('status', models.CharField(choices=[('scheduled', 'Programmée'), ('confirmed', 'Confirmée'), ('completed', 'Terminée'), ('cancelled', 'Annulée'), ('no_show', 'Absent')], default='scheduled', max_length=20)),
                ('notes', models.TextField(blank=True, help_text='Notes du client')),
                ('visitor_notes', models.TextField(blank=True)),
                ('agent_notes', models.TextField(blank=True)),
                ('feedback', models.TextField(blank=True)),
                ('rating', models.PositiveIntegerField(blank=True, null=True, validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(5)])),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('confirmed_at', models.DateTimeField(blank=True, null=True)),
                ('completed_at', models.DateTimeField(blank=True, null=True)),
                ('agent', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='agent_visits', to=settings.AUTH_USER_MODEL)),
                ('client', models.ForeignKey(help_text='Client who requested the visit', on_delete=django.db.models.deletion.CASCADE, related_name='client_visits', to=settings.AUTH_USER_MODEL)),
                ('property', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='visits', to='properties.property')),
            ],
            options={
                'verbose_name': 'Property Visit',
                'verbose_name_plural': 'Property Visits',
                'db_table': 'property_visits',
                'ordering': ['scheduled_date'],
                'indexes': [models.Index(fields=['property', 'scheduled_date'], name='property_vi_propert_929056_idx'), models.Index(fields=['client'], name='property_vi_client__02efd9_idx'), models.Index(fields=['status'], name='property_vi_status_e5c647_idx'), models.Index(fields=['agent'], name='property_vi_agent_i_7da2dd_idx')],
            },
        ),
        migrations.CreateModel(
            name='PropertySearch',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('name', models.CharField(max_length=200)),
                ('description', models.TextField(blank=True)),
                ('search_criteria', models.JSONField(default=dict)),
                ('email_notifications', models.BooleanField(default=True)),
                ('sms_notifications', models.BooleanField(default=False)),
                ('frequency', models.CharField(choices=[('immediate', 'Immédiat'), ('daily', 'Quotidien'), ('weekly', 'Hebdomadaire')], default='daily', max_length=20)),
                ('is_active', models.BooleanField(default=True)),
                ('last_run', models.DateTimeField(blank=True, null=True)),
                ('results_count', models.PositiveIntegerField(default=0)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('agency', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='property_searches', to='custom_auth.agency')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='property_searches', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Property Search',
                'verbose_name_plural': 'Property Searches',
                'db_table': 'property_searches',
                'ordering': ['-created_at'],
                'indexes': [models.Index(fields=['user', 'is_active'], name='property_se_user_id_2b755c_idx'), models.Index(fields=['agency'], name='property_se_agency__c3c383_idx')],
            },
        ),
        migrations.CreateModel(
            name='PropertyImage',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('image', models.ImageField(upload_to='properties/images/')),
                ('thumbnail', models.ImageField(blank=True, null=True, upload_to='properties/thumbnails/')),
                ('title', models.CharField(blank=True, max_length=200)),
                ('description', models.TextField(blank=True, max_length=500)),
                ('alt_text', models.CharField(blank=True, max_length=200)),
                ('order', models.PositiveIntegerField(default=0)),
                ('is_primary', models.BooleanField(default=False)),
                ('file_size', models.PositiveIntegerField(blank=True, null=True)),
                ('width', models.PositiveIntegerField(blank=True, null=True)),
                ('height', models.PositiveIntegerField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('property', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='images', to='properties.property')),
            ],
            options={
                'verbose_name': 'Property Image',
                'verbose_name_plural': 'Property Images',
                'db_table': 'property_images',
                'ordering': ['order', 'created_at'],
                'indexes': [models.Index(fields=['property', 'order'], name='property_im_propert_3dfd5d_idx'), models.Index(fields=['is_primary'], name='property_im_is_prim_119a09_idx')],
            },
        ),
        migrations.CreateModel(
            name='PropertyHistory',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('action', models.CharField(choices=[('created', 'Créé'), ('updated', 'Modifié'), ('status_changed', 'Statut modifié'), ('price_changed', 'Prix modifié'), ('published', 'Publié'), ('archived', 'Archivé'), ('deleted', 'Supprimé')], max_length=20)),
                ('field_name', models.CharField(blank=True, max_length=100)),
                ('old_value', models.TextField(blank=True)),
                ('new_value', models.TextField(blank=True)),
                ('change_reason', models.CharField(blank=True, max_length=500)),
                ('ip_address', models.GenericIPAddressField(blank=True, null=True)),
                ('user_agent', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('changed_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
                ('property', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='history', to='properties.property')),
            ],
            options={
                'verbose_name': 'Property History',
                'verbose_name_plural': 'Property History',
                'db_table': 'property_history',
                'ordering': ['-created_at'],
                'indexes': [models.Index(fields=['property', 'created_at'], name='property_hi_propert_806e51_idx'), models.Index(fields=['action'], name='property_hi_action_7504db_idx'), models.Index(fields=['changed_by'], name='property_hi_changed_553e5c_idx')],
            },
        ),
        migrations.CreateModel(
            name='PropertyDocument',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('title', models.CharField(max_length=200)),
                ('document_type', models.CharField(choices=[('floor_plan', "Plan de l'étage"), ('certificate', 'Certificat'), ('deed', 'Acte de propriété'), ('diagnosis', 'Diagnostic'), ('insurance', 'Assurance'), ('contract', 'Contrat'), ('photo', 'Photo'), ('other', 'Autre')], max_length=20)),
                ('document_file', models.FileField(upload_to='properties/documents/')),
                ('is_public', models.BooleanField(default=False, help_text='Disponible publiquement')),
                ('requires_auth', models.BooleanField(default=True, help_text='Nécessite une authentification pour accéder')),
                ('file_size', models.PositiveIntegerField(blank=True, null=True)),
                ('mime_type', models.CharField(blank=True, max_length=100)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('property', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='documents', to='properties.property')),
            ],
            options={
                'verbose_name': 'Property Document',
                'verbose_name_plural': 'Property Documents',
                'db_table': 'property_documents',
                'ordering': ['-created_at'],
                'indexes': [models.Index(fields=['property', 'document_type'], name='property_do_propert_57960d_idx'), models.Index(fields=['is_public'], name='property_do_is_publ_8fcdb5_idx')],
            },
        ),
        migrations.AddIndex(
            model_name='property',
            index=models.Index(fields=['property_type', 'status'], name='properties_propert_08af30_idx'),
        ),
        migrations.AddIndex(
            model_name='property',
            index=models.Index(fields=['city', 'postal_code'], name='properties_city_76bc10_idx'),
        ),
        migrations.AddIndex(
            model_name='property',
            index=models.Index(fields=['price'], name='properties_price_aa33af_idx'),
        ),
        migrations.AddIndex(
            model_name='property',
            index=models.Index(fields=['surface_area'], name='properties_surface_12f14f_idx'),
        ),
        migrations.AddIndex(
            model_name='property',
            index=models.Index(fields=['is_featured', 'status'], name='properties_is_feat_a6c37b_idx'),
        ),
        migrations.AddIndex(
            model_name='property',
            index=models.Index(fields=['published_at'], name='properties_publish_4bc7e5_idx'),
        ),
    ]
